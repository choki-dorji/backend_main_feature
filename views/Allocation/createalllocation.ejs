
<!-- <style>
  /* Block div  */
#block13 .bx-shadow {
    box-shadow: 0 0 20px rgba(77, 77, 77, 0.25); /* adds a box shadow */
    height: auto;
    background-color: #ffffff; /* sets the background color */
    border-radius: 10px; /* rounds the corners */
    margin: 7.4rem -1rem 0 2.2rem;
  }

  #block13 .allooo {
    text-align: center;

    margin: 0 auto;
    padding-top: 3rem;
    font-size: 18px;
  }
  #block13 .fo {
    margin-top: 2rem;
  }
  #block13 .row .form-select {
    border-color: #ff4b13;
    color: #4f4f4f;
    padding: 4px 10px;
    border-radius: 5px;
    opacity: 90%;
  }

  #block13 .form-select option:hover {
    background-color: #ff4b13;
    color: #4f4f4f;
    opacity: 90%;
  }
  #block13 .gee {
    display: flex;
    flex-direction: row;
  }
  #block13 .gee .gen-male {
    position: absolute;
    right: 3rem;
  }
  #block13 .boxx {
    position: relative;
    border: 1px solid #878787;
    opacity: 90%;
    width: 60%;
    height: auto;
    border-radius: 5px;
    margin-top: 4rem;
    padding-top: 1rem;
    left: 23%;
  }
  #block13 .boxx1 {
    right: 3rem;
  }
  #block13 .gen-female {
    margin-bottom: -2rem;
    margin-left: 1.4rem;
  }

  .round-checkbox {
    display: inline-block;
    width: 1em;
    height: 1em;
    margin-left: -27%;
    margin-top: 8px;
    background-color: #fff;
    border: 1px solid #6c757d;
    border-radius: 50%;
    transition: all 0.3s;
  }
  .round-checkbox:before {
    content: "";
    display: block;
    width: 0.5em;
    height: 0.5em;
    margin: 0.2em;
    background-color: #6c757d;
    border-radius: 50%;
    opacity: 0;
    transform: scale(0);
    transition: all 0.3s;
  }
  .form-check-input:checked + .form-check-label .round-checkbox:before {
    opacity: 1;
    transform: scale(1);
  }
  .fll {
    display: flex;
  }
  #block13 .slott {
    display: flex;
    position: absolute;
    margin-left: 45%;
    margin-top: -1.5rem;
    width: 100px;
    font-weight: thin;
    font-size: 14px;
    color: #4f4f4f;
  }
  #block13 .inssu {
    font-size: 12px;
    margin-left: 23%;
    opacity: 90%;
    margin-top: 10px;
    width: 60%;
  }
  #block13 .inss {
    font-size: 12px;
    margin-left: 23%;
    opacity: 90%;
    margin-top: 13px;
    width: 60%;
  }

  #block13 .allo-button {
    width: 20%;
    margin: 0 auto;
    height: 40px;
    border-radius: 5px;
    background: #ff4b13;
    color: #ffffff;
    opacity: 90%;
    /* margin-left: 39%; */
    display: flex;
    margin-top: 3rem;
    text-align: center;
  }
  #block13 .al- {
    padding-left: 38%;
    margin-top: 5px;
  }
  @media (max-width: 993px) {
    #block13 .gee {
      display: flex;
      flex-direction: column;
    }
    #block13 .gen-male {
      /* margin-right: 36%; */
      padding-top: 1rem;
      width: 50%;
      margin: 0px -1.7rem;
    }
    #block13 .boxx1 {
      top: -2.5rem;
    }
    #block13 .boxx {
      margin-top: 3.8rem;
    }
    #block13 .gen-female {
      /* margin-right: 36%; */
      padding-top: 2rem;
      width: 50%;
      margin: 0px 45%;
    }
    #block13 .allo-button {
      width: 58%;
      margin-left: 24%;
    }
    #block13 .al- {
      margin-left: 3%;
    }
    #block13 .inss {
      font-size: 12px;
      margin-left: 23%;
      opacity: 90%;
      margin-top: -28px;
      width: 60%;
    }
    @media (max-width: 767px) {
    }
    #block13 .allo-button {
      margin-top: -0.2rem;
    }
    #block13 .al- {
      padding-left: -10px;
      margin-left: -1%;
    }
  }
  @media (max-width: 575.7px) {
    #block13 .add {
      margin-top: 15px;
      width: 80%;
    }
  }

</style>
<main>
  <main id="block13">
      <div class="row">
          <div class="col-lg-12 col-md-12 col-sm-12">
              <div class="bx-shadow ">
                  <h5 class="allooo text-center">Room Allocation</h5>
                  <div class="form-group  fo text-center">
                      <label for="exampleSelect">Select student year
                          :</label>
                      <select class="form-select" id=" exampleSelect">
                          <option>2023</option>
                          <option> 2022</option>
                          <option>2021</option>
                      </select>
                  </div>
                  <div class="gee">
                      <div class="col-lg-6 col-md-12 col-sm-12 gend">
                          <div class="gen-male" style="opacity:90%;">
                              <p class="gen" style="color:#4f4f4f; font-weight:light;">Male: <span calss=""
                                      style="color:#ff4b13">24</span></p>
                          </div>
                          <div class="boxx">
                              <div class=" form-check-inline ml-4 fll">
                                  <input class="form-check-input" type="checkbox" id="checkbox1">
                                  <label class="form-check-label" for="checkbox1">
                                      <span class="round-checkbox"></span>
                                      Block A<span class="slott">24
                                          <p style="padding-left:.5rem;"> slots</p>
                                      </span>
                                  </label>
                              </div>
                              <div class=" form-check-inline ml-4 fll">
                                  <input class="form-check-input" type="checkbox" id="checkbox2">
                                  <label class="form-check-label" for="checkbox2">
                                      <span class="round-checkbox"></span>
                                      Block A <span class="slott">24
                                          <p style="padding-left:.5rem;"> slots</p>
                                      </span>
                                  </label>
                              </div>
                              <div class=" form-check-inline ml-4 fll ">
                                  <input class="form-check-input" type="checkbox" id="checkbox3">
                                  <label class="form-check-label" for="checkbox3">
                                      <span class="round-checkbox"></span>
                                      Block A<span class="slott">24
                                          <p style="padding-left:.5rem;"> slots</p>
                                      </span>
                                  </label>
                              </div>
                              <div class=" form-check-inline ml-4 fll">
                                  <input class="form-check-input" type="checkbox" id="checkbox4">
                                  <label class="form-check-label" for="checkbox4">
                                      <span class="round-checkbox"></span>
                                      Block A<span class="slott">24
                                          <p style="padding-left:.5rem;"> slots</p>
                                      </span>
                                  </label>
                              </div>
                              <br>
                          </div>
                          <p class="inssu">
                              Insufficient
                              slots. Please
                              select
                              another block.
                          </p>

                      </div>
                      <div class="col-lg-6 col-md-12 col-sm-12 gend">
                          <div class="gen-female" style="opacity:90%;">
                              <p class="gen" style="color:#4f4f4f; font-weight:light;">Female: <span calss=""
                                      style="color:#ff4b13">24</span></p>
                          </div>
                          <div class="boxx boxx1">
                              <div class=" form-check-inline ml-4 fll">
                                  <input class="form-check-input" type="checkbox" id="checkbox5">
                                  <label class="form-check-label" for="checkbox5">
                                      <span class="round-checkbox"></span>
                                      Block A<span class="slott">24
                                          <p style="padding-left:.5rem;"> slots</p>
                                      </span>
                                  </label>
                              </div>
                              <div class=" form-check-inline ml-4 fll">
                                  <input class="form-check-input" type="checkbox" id="checkbox6">
                                  <label class="form-check-label" for="checkbox6">
                                      <span class="round-checkbox"></span>
                                      Block A <span class="slott">24
                                          <p style="padding-left:.5rem;"> slots</p>
                                      </span>
                                  </label>
                              </div>
                              <div class=" form-check-inline ml-4 fll ">
                                  <input class="form-check-input" type="checkbox" id="checkbox7">
                                  <label class="form-check-label" for="checkbox7">
                                      <span class="round-checkbox"></span>
                                      Block A<span class="slott">24
                                          <p style="padding-left:.5rem;"> slots</p>
                                      </span>
                                  </label>
                              </div>
                              <div class=" form-check-inline ml-4 fll">
                                  <input class="form-check-input" type="checkbox" id="checkbox8">
                                  <label class="form-check-label" for="checkbox8">
                                      <span class="round-checkbox"></span>
                                      Block A<span class="slott">24
                                          <p style="padding-left:.5rem;"> slots</p>
                                      </span>
                                  </label>
                              </div>
                              <br>
                          </div>
                          <p class="inss">
                              Insufficient
                              slots. Please
                              select
                              another block.
                          </p>

                      </div>

                  </div>
                  <a style="cursor:pointer;" class="">
                      <div class="allo-button">
                          <p class="al-">Allocate</p>
                      </div>
                  </a>
                  <br><br><br><br><br><br><br>
              </div>
          </div>
      </div>
  </main>
</main>
<br>
</section>

</body>

</main>

</section>


</script>

</body>

</html> -->





<style>
  body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f2f2f2;
  }
  .form-container {
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      max-width: 500px;
      width: 100%;
  }
  h2 {
      text-align: center;
      margin-bottom: 20px;
  }
  .form-select {
      display: block;
      width: 100%;
      padding: 10px;
      margin-bottom: 20px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
  }
  .form-group {
      margin-bottom: 20px;
  }
  .form-group-label {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 10px;
  }
  .form-checkboxes {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
  }
  .form-checkbox {
      display: flex;
      align-items: center;
      font-size: 16px;
  }
  .form-checkbox input[type="checkbox"] {
      margin-right: 10px;
  }
  input[type="submit"] {
      display: block;
      margin: 20px auto 0;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 5px;
      border: none;
      background-color: #4CAF50;
      color: #fff;
      cursor: pointer;
  }
  input[type="submit"]:hover {
      background-color: #3e8e41;
  }
</style>

<div class="form-container">
    <h2>Create Allocation</h2>
    <form class="form-wrapper" onsubmit="submitNewForm(event)">
      <select class="form-select" id="year-select" name="year-select" onchange="getTotalStudents()">
        <option value="1">Year 1</option>
        <option value="2">Year 2</option>
        <option value="3">Year 3</option>
        <option value="4">Year 4</option>
      </select>
      <p id="total-students"></p>


      <div class="form-group">
        <div class="form-group-label">select boys Hostel</div>
        <div class="form-checkboxes">
        <% for(var i = 0; i < block.length; i++) { %>
          <% if(block[i].type === "boys") { %>
              <label class="form-checkbox">
                <input type="checkbox" id="group1-option<%= i %>" name="group1-option1" value="<%= block[i]._id %>">
                <span class="form-checkbox-label"><%= block[i].block_name %></span>

              </label>
              <p><%= block[i].no_of_rooms %></p>
          <% } %>

        <% } %>

        </div>
      </div>

      <div class="form-group">
        <div class="form-group-label">select girls Hostel</div>
        <div class="form-checkboxes">
            <% for(var i = 0; i < block.length; i++) { %>
              <% if(block[i].type === "girls") { %>
                <label class="form-checkbox">
                  <input type="checkbox" id="group2-option<%= i %>" name="group2-option1" value="<%= block[i]._id %>">
                  <span class="form-checkbox-label"><%= block[i].block_name %></span><br>

                </label>
                <p><%= block[i].rooms.length %></p>
                <% } %>
              <% } %>
        </div>
      </div>

      <input type="submit" value="Submit">
    </form>
  </div>

  <script>
    function getTotalStudents() {
      const yearSelect = document.getElementById("year-select").value;

      fetch(`http://localhost:3000/students/students/${yearSelect}`)
        .then(response => {
          if (!response.ok) {
            throw new Error('Failed to fetch student data');
          }
          return response.json();
        })
        .then(data => {
          console.log(data)
          const maleStudents = data.totalMaleStudents;
          const femaleStudents = data.totalFemaleStudents;

          const totalStudentsElement = document.getElementById('total-students');
          totalStudentsElement.innerHTML = `male: ${maleStudents} female: ${femaleStudents}`;


          console.log(maleStudents, femaleStudents)
        })
        .catch(error => {
          console.error(error);
        });
    }
  </script>


  <script>
     // Add a function to submit the new form
     function submitNewForm(event) {
  event.preventDefault();

  const yearSelect = document.getElementById("year-select").value;
  const maleBlocks = document.querySelectorAll('input[name="group1-option1"], input[name="group1-option2"], input[name="group1-option3"]');
  const femaleBlocks = document.querySelectorAll('input[name="group2-option1"], input[name="group2-option2"], input[name="group2-option3"]');

  const selectedMaleBlocks = [];
  maleBlocks.forEach(block => {
    if (block.checked) {
      selectedMaleBlocks.push(block.value);
    }
  });

  const selectedFemaleBlocks = [];
  femaleBlocks.forEach(block => {
    if (block.checked) {
      selectedFemaleBlocks.push(block.value);
    }
  });
  const queryParams = new URLSearchParams(window.location.search);
  const year = queryParams.get("year");
  console.log("////////////////////////////////////////////////", year)

  const data = { years: parseInt(yearSelect), maleBlock: selectedMaleBlocks, femaleBlock: selectedFemaleBlocks };

  console.log(data)

  fetch(`http://localhost:5000/Allocate/api/years/${year}`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(data)
  })
  .then(response => {
    if (!response.ok) {
      throw new Error('Failed to allocate rooms');
    }
    return response.json();
  })
  .then(data => {
    console.log(data.message);
    alert("Room Allocated successfully")
  })
  .catch(error => {
    console.error(error);
  });
}


  </script>
